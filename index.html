<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Datas</title>
    <!-- Utilizando Tailwind CSS para a estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos adicionais para transições suaves */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4 font-sans text-slate-800">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden">
        <!-- Cabeçalho -->
        <div class="bg-indigo-600 p-6 text-white text-center">
            <h1 class="text-2xl font-bold flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 256 256"><path d="M208,32H184V24a8,8,0,0,0-16,0v8H88V24a8,8,0,0,0-16,0v8H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM72,48v8a8,8,0,0,0,16,0V48h80v8a8,8,0,0,0,16,0V48h24V80H48V48ZM208,208H48V96H208V208Z"></path></svg>
                Calculadora de Datas
            </h1>
            <p class="text-indigo-200 text-sm mt-1">Simples, rápida e precisa</p>
        </div>

        <!-- Abas de Navegação -->
        <div class="flex border-b border-slate-200">
            <button onclick="switchTab('tab-add')" id="btn-tab-add" class="flex-1 py-3 text-sm font-semibold text-indigo-600 border-b-2 border-indigo-600 transition-colors">
                Somar/Subtrair Dias
            </button>
            <button onclick="switchTab('tab-diff')" id="btn-tab-diff" class="flex-1 py-3 text-sm font-semibold text-slate-500 border-b-2 border-transparent hover:text-indigo-500 transition-colors">
                Diferença de Datas
            </button>
        </div>

        <div class="p-6">
            <!-- ABA 1: Somar/Subtrair Dias -->
            <div id="tab-add" class="tab-content active">
                <form id="form-add" onsubmit="event.preventDefault(); calculateFinalDate();" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Data Inicial</label>
                        <input type="date" id="add-start-date" required class="w-full p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Qtd de Dias</label>
                            <input type="number" id="add-days" required placeholder="Ex: 15 ou -5" class="w-full p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Tipo de Dia</label>
                            <select id="add-type" class="w-full p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all bg-white">
                                <option value="corridos">Corridos</option>
                                <option value="uteis">Úteis</option>
                            </select>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg transition-colors mt-2">
                        Calcular Data Final
                    </button>
                </form>

                <!-- Resultado Aba 1 -->
                <div id="result-add" class="hidden mt-6 p-4 bg-indigo-50 rounded-lg border border-indigo-100 text-center">
                    <p class="text-sm text-indigo-800 mb-1">A data final será:</p>
                    <p id="result-add-date" class="text-2xl font-bold text-indigo-600"></p>
                    <p id="result-add-detail" class="text-xs text-indigo-500 mt-1"></p>
                </div>
            </div>

            <!-- ABA 2: Diferença entre Datas -->
            <div id="tab-diff" class="tab-content">
                <form id="form-diff" onsubmit="event.preventDefault(); calculateDateDifference();" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Primeira Data</label>
                        <input type="date" id="diff-date-1" required class="w-full p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-1">Segunda Data</label>
                        <input type="date" id="diff-date-2" required class="w-full p-2.5 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all">
                    </div>

                    <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg transition-colors mt-2">
                        Calcular Diferença
                    </button>
                </form>

                <!-- Resultado Aba 2 -->
                <div id="result-diff" class="hidden mt-6 grid grid-cols-2 gap-3">
                    <div class="p-4 bg-blue-50 rounded-lg border border-blue-100 text-center">
                        <p class="text-xs text-blue-600 uppercase font-semibold tracking-wider">Dias Corridos</p>
                        <p id="result-diff-corridos" class="text-2xl font-bold text-blue-700 mt-1"></p>
                    </div>
                    <div class="p-4 bg-emerald-50 rounded-lg border border-emerald-100 text-center">
                        <p class="text-xs text-emerald-600 uppercase font-semibold tracking-wider">Dias Úteis</p>
                        <p id="result-diff-uteis" class="text-2xl font-bold text-emerald-700 mt-1"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Preenche com a data de hoje ao carregar
        window.onload = () => {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('add-start-date').value = today;
            document.getElementById('diff-date-1').value = today;
        };

        // Função para alternar entre as abas
        function switchTab(tabId) {
            // Esconde todos os conteúdos
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            // Remove o estilo ativo dos botões
            document.getElementById('btn-tab-add').className = "flex-1 py-3 text-sm font-semibold text-slate-500 border-b-2 border-transparent hover:text-indigo-500 transition-colors";
            document.getElementById('btn-tab-diff').className = "flex-1 py-3 text-sm font-semibold text-slate-500 border-b-2 border-transparent hover:text-indigo-500 transition-colors";
            
            // Ativa a aba selecionada
            document.getElementById(tabId).classList.add('active');
            document.getElementById(`btn-${tabId}`).className = "flex-1 py-3 text-sm font-semibold text-indigo-600 border-b-2 border-indigo-600 transition-colors";
            
            // Oculta resultados anteriores ao trocar de aba
            document.getElementById('result-add').classList.add('hidden');
            document.getElementById('result-diff').classList.add('hidden');
        }

        // Função auxiliar para criar Data de forma segura (evita problema de fuso horário onde o dia volta -1)
        function parseDate(dateString) {
            const [year, month, day] = dateString.split('-');
            return new Date(year, month - 1, day);
        }

        // Formata data para o padrão Brasileiro
        function formatDateBR(date) {
            const diasSemana = ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'];
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            const diaSemana = diasSemana[date.getDay()];
            return {
                curta: `${day}/${month}/${year}`,
                longa: diaSemana
            };
        }

        // LÓGICA DA ABA 1: Somar/Subtrair
        function calculateFinalDate() {
            const startDateStr = document.getElementById('add-start-date').value;
            const daysToAdd = parseInt(document.getElementById('add-days').value);
            const calcType = document.getElementById('add-type').value;

            if (!startDateStr || isNaN(daysToAdd)) return;

            let currentDate = parseDate(startDateStr);
            let addedDays = 0;
            const step = daysToAdd >= 0 ? 1 : -1;
            const absDays = Math.abs(daysToAdd);

            if (calcType === 'corridos') {
                // Cálculo de dias corridos (matemática simples)
                currentDate.setDate(currentDate.getDate() + daysToAdd);
            } else {
                // Cálculo de dias úteis (pula sábado = 6 e domingo = 0)
                while (addedDays < absDays) {
                    currentDate.setDate(currentDate.getDate() + step);
                    const dayOfWeek = currentDate.getDay();
                    if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                        addedDays++;
                    }
                }
            }

            const formatted = formatDateBR(currentDate);
            
            document.getElementById('result-add-date').textContent = formatted.curta;
            document.getElementById('result-add-detail').textContent = formatted.longa;
            document.getElementById('result-add').classList.remove('hidden');
        }

        // LÓGICA DA ABA 2: Diferença
        function calculateDateDifference() {
            const date1Str = document.getElementById('diff-date-1').value;
            const date2Str = document.getElementById('diff-date-2').value;

            if (!date1Str || !date2Str) return;

            let d1 = parseDate(date1Str);
            let d2 = parseDate(date2Str);

            // Garante que d1 seja sempre a data mais antiga para facilitar o loop
            if (d1 > d2) {
                const temp = d1;
                d1 = d2;
                d2 = temp;
            }

            // Cálculo Dias Corridos
            const diffTime = Math.abs(d2 - d1);
            const diffCorridos = Math.round(diffTime / (1000 * 60 * 60 * 24));

            // Cálculo Dias Úteis
            let diffUteis = 0;
            let current = new Date(d1);
            
            while (current < d2) {
                current.setDate(current.getDate() + 1);
                const dayOfWeek = current.getDay();
                // Se não for domingo (0) nem sábado (6), é dia útil
                if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                    diffUteis++;
                }
            }

            document.getElementById('result-diff-corridos').textContent = diffCorridos;
            document.getElementById('result-diff-uteis').textContent = diffUteis;
            document.getElementById('result-diff').classList.remove('hidden');
        }
    </script>
</body>
</html>
